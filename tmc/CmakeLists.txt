add_subdirectory(helpers)
add_subdirectory(ic)
add_subdirectory(ramp)

# Add library target
add_library(tmc_library
    ${TMC_HELPERS_SOURCES}
    ${TMC_IC_SOURCES}
    ${TMC_RAMP_SOURCES}
)

# Set include directories for library
target_include_directories(tmc_library PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})

# Recursively add subdirectories of ic
file(GLOB IC_SUBDIRS RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}/ic ${CMAKE_CURRENT_SOURCE_DIR}/ic/*)
foreach(subdir ${IC_SUBDIRS})
    if(IS_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/ic/${subdir})
        add_subdirectory(ic/${subdir})
        target_sources(tmc_library PRIVATE $<TARGET_OBJECTS:${subdir}_objects>)
    endif()
endforeach()